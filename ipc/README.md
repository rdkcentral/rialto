# RialtoIpc Library

This library is used to implement a client channel and server for the Google [protobuf][1] [RPC interface][2].
In addition, it adds extensions to support sending asynchronous events and passing unix file descriptors in RPC
calls and events.

The 'library' is actually three libraries, a client side and server side library and a 'common' library that
contains shared code between server and client.  The reason for this is to allow a process to be both a client
and server without having symbol clash.

All transfers are over local unix domain sockets.

### Dependencies
The only dependency is [protobuf][1], minimum version is 3.6.

### Server-side Library
* A single server instance can create multiple listening unix domain sockets.
* The server allows for registering zero or more services (protobuf defined service) for a client connection.
* The server can receive RPC method calls and response with a reply or error message.
* The server can send single protobuf messages, these are asynchronous events.
* The server provides an optional monitor interface that can be used by external programs to monitor all traffic sent
  to / from the server.

### Client-side Library
* Clients can make RPC calls using stub c++ code generated by protobuf compiler.
* Clients can register to receive events from the server.
* Clients cannot send events to the server.

### Both Client and Server Libraries
* Neither library contains any internal threads, each must be driven by an external event loop.


## Questions

### What is Protobuf ?
Protobuf is a host compiler tool and library for taking .proto (text) files describing the format of a message or
service and generating code to serialise and deserialise the messages to / from binary data.  It is used in this
library to generate c++ stub code for implementing RPC services.

### Why not use gRPC ?
[gRPC][3] is built on top of protobuf but also provides the client library code to implement transport across various
different protocols (unix sockets, http, websockets, etc), in this sense it provides the same RPC support.  However
since it is more generic it lacks some specific things needed by Rialto:
* Client management - the ability to associate a call with a specific client and get the client details (ie. pid or uid).
* File descriptor passing - it has no support for sending or receiving file descriptors.
* Sending asynchronous events - it doesn't have support for sending asynchronous events, although it does have a concept
 of a stream of messages which possibly could be adapted.




[1]: https://developers.google.com/protocol-buffers
[2]: https://developers.google.com/protocol-buffers/docs/proto#services
[3]: https://grpc.io
